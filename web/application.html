<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>3DReconstruction_of_one_room</title>
    <link rel="stylesheet" href="css/application_css.css"> <!-- CSS 파일 링크 -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box; /* 박스 모델 설정 */
        }
        @font-face {
            font-family: 'Spoqa Han Sans Neo';
            src: url('css/font/SpoqaHanSansNeo_TTF_original/SpoqaHanSansNeo_TTF_original/SpoqaHanSansNeo-Bold.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
        }
        html, body {
            height: 100%; /* 높이를 100%로 설정 */
        }
       
    </style>
</head>
<body>
	<div id="banner">미리보는 내 자취방</div> <!-- 배너 추가 -->

    <div id="buttonContainer">
        <div class="buttonGroup">
            <div class="inputContainer">
                <input type="text" class="inputField" placeholder="지역을 입력해주세요" id="locationinput"/>
                <button class="searchButton" id="searchButton">
                    <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="34.3px" height="34.3px">    
                        <path fill="white" d="M 9 2 C 5.1458514 2 2 5.1458514 2 9 C 2 12.854149 5.1458514 16 9 16 C 10.747998 16 12.345009 15.348024 13.574219 14.28125 L 14 14.707031 L 14 16 L 19.585938 21.585938 C 20.137937 22.137937 21.033938 22.137938 21.585938 21.585938 C 22.137938 21.033938 22.137938 20.137938 21.585938 19.585938 L 16 14 L 14.707031 14 L 14.28125 13.574219 C 15.348024 12.345009 16 10.747998 16 9 C 16 5.1458514 12.854149 2 9 2 z M 9 4 C 11.773268 4 14 6.2267316 14 9 C 14 11.773268 11.773268 14 9 14 C 6.2267316 14 4 11.773268 4 9 C 4 6.2267316 6.2267316 4 9 4 z"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="buttonGroup">
        <p class="text">전/월세를 선택해주세요</p> <!-- 버튼 사이에 텍스트 추가 -->
        <div class="buttonRow">
            <button class="rotateButton" id="Rent1">전세</button>
            <button class="rotateButton" id="Rent2">월세</button>
        </div>
        </div>
        <div class="buttonGroup hidden" id="depositGroup">
            <p class="text">보증금 가격을 선택해주세요</p> <!-- 버튼 사이에 텍스트 추가 -->
            <div class="buttonRow">
                <button class="rotateButton" id="depositprice1">300만원 이하</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="depositprice2">300만원이상</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="depositprice3">500만원 이상</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="depositprice4">1000만원 이상</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
            </div>
        </div>
        <div class="buttonGroup hidden" id="monthrentGroup">
            <p class="text">월세 가격을 선택해​주세요</p> <!-- 버튼 사이에 텍스트 추가 -->
            <div class="buttonRow">
                <button class="rotateButton" id="monthprice1">50만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="monthprice2">70만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="monthprice3">90만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="monthprice4">100만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->  
            </div>
        </div>
        <div class="buttonGroup hidden" id="rentGroup">
            <p class="text">전세 가격을 선택해​주세요</p> <!-- 버튼 사이에 텍스트 추가 -->
            <div class="buttonRow">
                <button class="rotateButton" id="rentprice1">5000만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="rentprice2">7000만원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="rentprice3">1억원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->
                <button class="rotateButton" id="rentprice4">2.5억원</button> <!-- 보증금 버튼을 전세 버튼 아래에 위치 -->  
            </div>
        </div>
    </div>

    <div id="sceneButtonContainer">
        <div class = "sceneGroup ">
        <div class="buttonRow">
            <button class="sceneButton hidden" id="openScene1Button">
                <p>1번방 <br>
                가격 : 얼마<br>
                옵션 : 세탁기, 에어컨 </p>
            </button>
        </div>
        </div>
        <div class = "sceneGroup ">
        <div class="buttonRow">
            <button class="sceneButton hidden" id="openScene2Button">
                <p>2번방 <br>
                    가격 : 얼마<br>
                    옵션 : 세탁기, 에어컨 </p>
            </button>
        </div>
        </div>
        <div class = "sceneGroup ">
        <div class="buttonRow">
            <button class="sceneButton hidden" id="openScene3Button">
                <p>3번방 <br>
                    가격 : 얼마<br>
                    옵션 : 세탁기, 에어컨 </p>
            </button>
        </div>
        </div>
    </div>
    <script>
        
        document.getElementById('searchButton').addEventListener('click', () => {
            const input = document.getElementById('locationinput');
            if (input.value) {
                //sendData(input.value);
                console.log("입력된 지역:", input.value); // 실제로는 원하는 동작으로 변경 가능
            }
        });
        document.getElementById('locationinput').addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                document.getElementById('searchButton').click();
            }
        }); 
        
        
        const groups = {
            deposit: document.getElementById('depositGroup'),
            rent: document.getElementById('rentGroup'),
            monthRent: document.getElementById('monthrentGroup')
        };

        const buttons = {
            Rent1 : () => {
                groups.rent.classList.remove('hidden') ;
                groups.deposit.classList.add('hidden');
                groups.monthRent.classList.add('hidden');
                toggleActiveButton('Rent1');
                reset('Rent1')
                saveGroupState();
            },
            Rent2: () => {
                groups.deposit.classList.remove('hidden');
                groups.rent.classList.add('hidden');
                toggleActiveButton('Rent2');
                reset('Rent2')
                saveGroupState();
            },
            depositprice1: () => {
                groups.monthRent.classList.remove('hidden');
                toggleActiveButton('depositprice1');
                saveGroupState();
            },
            depositprice2: () => {
                groups.monthRent.classList.remove('hidden');
                toggleActiveButton('depositprice2');
                saveGroupState();
            },
            depositprice3: () => {
                groups.monthRent.classList.remove('hidden');
                toggleActiveButton('depositprice3');
                saveGroupState();
            },
            depositprice4: () => {
                groups.monthRent.classList.remove('hidden');
                toggleActiveButton('depositprice4');
                saveGroupState();
            },
            monthprice1: () => {
                toggleActiveButton('monthprice1');
                saveGroupState();
            },
            monthprice2: () => {
                toggleActiveButton('monthprice2');
                saveGroupState();
            },
            monthprice3: () => {
                toggleActiveButton('monthprice3');
                saveGroupState();
            },
            monthprice4: () => {
                toggleActiveButton('monthprice4');
                saveGroupState();
            },
            rentprice1: () => {
                toggleActiveButton('rentprice1');
                saveGroupState();
            },
            rentprice2: () => {
                toggleActiveButton('rentprice2');
                saveGroupState();
            },
            rentprice3: () => {
                toggleActiveButton('rentprice3');
                saveGroupState();
            },
            rentprice4: () => {
                toggleActiveButton('rentprice4');
                saveGroupState();
            },
        };

        // 버튼 클릭 이벤트 리스너 등록
        for (const [buttonId, action] of Object.entries(buttons)) {
            const buttonElement = document.getElementById(buttonId);

            buttonElement.addEventListener('click', () => {
                action();
                const buttonText = buttonElement.innerText
                //sendData(buttonText)
                localStorage.setItem(`buttonState${buttonId}`,buttonElement.classList.contains('activeButton'))
            });
        }

        const sceneButtons = [
        'openScene1Button',
        'openScene2Button',
        'openScene3Button'
        ];

        sceneButtons.forEach(buttonId => {
            document.getElementById(buttonId).addEventListener('click', () => {
                window.location.href = 'threeDpage.html'; // 새로운 페이지에서 씬 열기
            });
        });

        window.onload =() => {
            restoreGroupState();
            for(const [buttonId,action] of Object.entries(buttons)) {
                const state = localStorage.getItem(`buttonState${buttonId}`);
                if (state == 'true') { 
                    //보증금 선택 창에 remove hidden넣기 
                    const buttonGroupPrefix = buttonId.charAt(0);
                    const buttonGroup = Object.keys(buttons).filter(buttonId => buttonId.startsWith(buttonGroupPrefix));
                    buttonGroup.forEach(buttonId => {
                        document.getElementById(buttonId).classList.remove('hidden')
                    })
                    document.getElementById(buttonId).classList.add('activeButton');
                }
            }
        };

        // rent 유형에 따른 버튼 초기화 함수
        function reset(clickedButtonId) { 
            const clickedButtonPrefix = clickedButtonId; 
            const activeButtons = [];
            for (const buttonId of Object.keys(buttons)) {
                if (buttonId != clickedButtonPrefix) {
                    activeButtons.push(buttonId);
                }
            }
            activeButtons.forEach(buttonId => {
                document.getElementById(buttonId).classList.remove('activeButton');
                localStorage.setItem(`buttonState${buttonId}`, 'false');
            });
        }
        
        // activeButton 클래스 토글 함수
        let lastClickedGroup = '';

        function toggleActiveButton(clickedButtonId) {
            const clickedButtonPrefix = clickedButtonId.charAt(0); // 클릭한 버튼의 앞글자
            const activeButtons = [];

            for (const buttonId of Object.keys(buttons)) {
                if (buttonId.charAt(0) === clickedButtonPrefix) {
                    activeButtons.push(buttonId);
                }
            }
            // 모든 버튼에서 activeButton 클래스 제거
            activeButtons.forEach(buttonId => {
                document.getElementById(buttonId).classList.remove('activeButton');
                localStorage.setItem(`buttonState${buttonId}`, 'false');
            });
        
            // 클릭한 버튼에 activeButton 클래스 추가
            document.getElementById(clickedButtonId).classList.add('activeButton');
            localStorage.setItem(`buttonState${clickedButtonId}`,`true`)

            lastClickedGroup = clickedButtonId;
            const sceneElements = document.querySelectorAll('.sceneButton');
            if (lastClickedGroup.startsWith('rentprice') || lastClickedGroup.startsWith('monthprice')) {
                sceneElements.forEach(sceneElement => {
                    sceneElement.classList.remove('hidden');
                });
            } else {
                sceneElements.forEach(sceneElement => {
                    sceneElement.classList.add('hidden'); // 모든 요소에서 hidden 클래스 추가
                });
            }

        }
        function saveGroupState() {
            Object.keys(groups).forEach(groupKey => {
                const group = groups[groupKey];
                localStorage.setItem(`${groupKey}Visible`, !group.classList.contains('hidden'));
            });
        }
        
        // 그룹 상태를 복원하는 함수
        function restoreGroupState() {
            Object.keys(groups).forEach(groupKey => {
                const isVisible = localStorage.getItem(`${groupKey}Visible`) === 'true';
                if (isVisible) {
                    groups[groupKey].classList.remove('hidden');
                } else {
                    groups[groupKey].classList.add('hidden');
                }
            });
        }
        /*function sendData(inform) {
            const data = {
                information : inform
            };
            fetch('sveData.php', {
                method : 'POST' ,
                headers: {
                    'Content-Type' : 'application/json'
                },
                body : JSON.stringify(data)
            })
            .then (response => response.json())
            .then(data => {
                console.log('Success:', data);
                alert('데이터가 성공적으로 전송되었습니다!');
            })
            .catch((error) => {
                console.error('Error:', error);
                alert('데이터 전송 중 오류가 발생했습니다.');
            });
        }*/
    </script>
</body>
</html>

